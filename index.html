<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Staff Login Form with Google Script Integration</title>
    <link href="https://unpkg.com/tailwindcss@3.3.2/dist/tailwind.min.css" rel="stylesheet" />
    <style>
        body {
            background-color: #f9fafb;
        }
        .container {
            max-width: 450px;
            margin: 40px auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .error {
            color: #dc2626;
            font-size: 0.875rem;
            margin-top: 4px;
        }
        .info {
            margin-top: 2rem;
            font-size: 0.875rem;
            color: #444444;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="text-2xl font-semibold mb-4">Staff Login Form</h2>
        <form id="staffForm" onsubmit="submitForm(event)">
            <label>Name</label>
            <input type="text" id="name" class="w-full p-2 mb-4 border rounded" placeholder="Enter your name" required />

            <label>eMail</label>
            <input type="email" id="email" class="w-full p-2 mb-4 border rounded" placeholder="Enter your email" required />

            <label>Staff ID</label>
            <input type="text" id="staffID" class="w-full p-2 mb-4 border rounded" placeholder="Enter your staff ID" required />

            <label>Unit</label>
            <select id="unit" class="w-full p-2 mb-2 border rounded" onchange="toggleOtherUnit(this.value)" required>
                <option value="">Select Unit</option>
                <option value="INBOUND">INBOUND</option>
                <option value="OUTBOUND">OUTBOUND</option>
                <option value="SERVICE EXCELLENCE">SERVICE EXCELLENCE</option>
                <option value="SOCIAL MEDIA">SOCIAL MEDIA</option>
                <option value="DIGITAL SUPPORT">DIGITAL SUPPORT</option>
                <option value="OTHER">Other</option>
            </select>
            <input type="text" id="otherUnit" class="w-full p-2 mb-4 border rounded hidden" placeholder="Please specify other unit" />

            <label>Shift</label>
            <select id="shift" class="w-full p-2 mb-4 border rounded" required>
                <option value="">Select Shift</option>
                <option value="MORNING">MORNING</option>
                <option value="REGULAR">REGULAR</option>
                <option value="AFTERNOON">AFTERNOON</option>
                <option value="NIGHT">NIGHT</option>
            </select>

            <input type="hidden" id="latitude" />
            <input type="hidden" id="longitude" />

            <button type="submit" class="w-full p-2 bg-blue-600 text-white rounded">
                Submit and Continue
            </button>
            <p id="errorMessage" class="error"></p>
        </form>

        <div class="info">
            After submitting this form, your data will be sent to the Google Apps Script.
        </div>
    </div>

    <script>
        function toggleOtherUnit(value) {
            const otherUnitInput = document.getElementById('otherUnit');
            if (value === 'OTHER') {
                otherUnitInput.classList.remove('hidden');
            } else {
                otherUnitInput.classList.add('hidden');
                otherUnitInput.value = '';
            }
        }

        async function submitForm(event) {
    event.preventDefault();

    const formData = {
        name: document.getElementById('name').value.trim(),
        email: document.getElementById('email').value.trim(),
        staffID: document.getElementById('staffID').value.trim(),
        unit: document.getElementById('unit').value.trim(),
        otherUnit: document.getElementById('otherUnit').value.trim(),
        shift: document.getElementById('shift').value.trim(),
        latitude: document.getElementById('latitude').value.trim(),
        longitude: document.getElementById('longitude').value.trim()
    };

    try {
        // Use a CORS proxy
        const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
        const targetUrl = 'https://script.google.com/macros/s/AKfycbxC6nVhoVr5LVAqITeih7KQPudjzbTsEjDc4LKhgVUOmPz85GaCdRPaNL3rZy8CaXPGgg/exec';
        
        const response = await fetch(proxyUrl + targetUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
        });

        if (!response.ok) throw new Error('Error submitting form');

        alert('Form submitted successfully');
        event.target.reset();
    } catch (error) {
        console.error('Form submission failed:', error);
        document.getElementById('errorMessage').textContent = 'Error submitting form. Please try again.';
    }
}
    </script>
</body>
</html>
