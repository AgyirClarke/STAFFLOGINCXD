function doPost(e) {
  const sheetId = "1-0gE2bqFcObsqqKIDoakfWQ_Zzb1iHta_uQ5eRmjyLk"; // Replace with your actual Google Sheet ID
  const allowedOrigin = "https://agyirclarke.github.io"; // Your GitHub Pages domain

  try {
    // Handle preflight (OPTIONS) requests
    if (e && e.method === "OPTIONS") {
      return HtmlService.createHtmlOutput("")
        .append("<meta http-equiv='Access-Control-Allow-Origin' content='" + allowedOrigin + "'>")
        .append("<meta http-equiv='Access-Control-Allow-Methods' content='POST, OPTIONS'>")
        .append("<meta http-equiv='Access-Control-Allow-Headers' content='Content-Type'>")
        .append("<meta http-equiv='Access-Control-Max-Age' content='3600'>");
    }

    // Log the incoming request for debugging
    Logger.log("Received Request: " + JSON.stringify(e));

    // Parse the incoming JSON data
    const data = JSON.parse(e.postData.contents);

    // Open the sheet
    const sheet = SpreadsheetApp.openById(sheetId).getActiveSheet();

    // Prepare the row to be added to the sheet
    const row = [
      new Date(),      // Timestamp
      data.name,
      data.email,
      data.signType,
      data.unit,
      data.shift,
      data.latitude,
      data.longitude
    ];

    // Append the row to the sheet
    sheet.appendRow(row);

    // Return a success response
    const response = {
      status: "success",
      message: "Feedback submitted successfully!"
    };

    return ContentService.createTextOutput(JSON.stringify(response))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    // Log the error for debugging
    Logger.log("Error Occurred: " + error.message);
    Logger.log("Stack Trace: " + error.stack);

    // Return an error response
    const errorResponse = {
      status: "error",
      message: error.message
    };

    return ContentService.createTextOutput(JSON.stringify(errorResponse))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
